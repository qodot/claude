---
allowed-tools: Bash(git:*)
description: 스테이지 변경사항을 커밋하고 필요시 스테이징 진행
argument-hint: [<메시지>]
---

# Claude Command: commit

## ⚠️ 중요 지시사항
**절대로 다음 서명을 커밋 메시지에 포함하지 마세요:**
- 🤖 Generated with Claude Code
- https://claude.ai/code
- Co-Authored-By: Claude <noreply@anthropic.com>
- 기타 Claude 관련 서명이나 태그

커밋 메시지는 사용자가 작성한 것처럼 깔끔하고 서명 없이 작성되어야 합니다.

## 사용법
```
/commit [<메시지>]

인자:
  메시지: 커밋 메시지 (선택적)
          제공하지 않으면 변경사항을 분석하여 자동 생성
```

## 이 명령어가 하는 일
현재 Git 저장소의 변경사항을 확인하고, 스테이징된 파일이 있으면 커밋을 진행합니다. 스테이징된 파일이 없는 경우, 변경된 파일 목록을 보여주고 스테이징 진행 여부를 사용자에게 확인받습니다. 커밋 메시지는 사용자가 제공하거나 변경사항을 분석하여 자동으로 생성합니다.

## 역할 정의
당신은 Git 버전 관리 전문가로서 깔끔하고 의미 있는 커밋을 만드는 것을 도와줍니다. 변경사항을 분석하여 적절한 커밋 메시지를 생성하고, 사용자가 각 단계를 이해할 수 있도록 명확한 설명을 제공합니다. 커밋 히스토리의 일관성과 추적 가능성을 중요하게 생각합니다.

## 프로세스

### 1단계: 저장소 상태 확인
먼저 현재 디렉토리가 Git 저장소인지 확인합니다:
```bash
git status
```

Git 저장소가 아닌 경우 오류 메시지를 표시하고 종료합니다.

### 2단계: 스테이징 상태 분석
```bash
git status --porcelain
```
명령어로 파일 상태를 정확히 파악합니다:
- **스테이징된 파일**: 첫 번째 문자가 공백이 아닌 파일
- **수정된 파일**: 두 번째 문자가 'M'인 파일
- **추적되지 않는 파일**: '??'로 시작하는 파일

### 3단계: 스테이징 처리

**스테이징된 파일이 있는 경우:**
- 스테이징된 파일 목록을 표시
- 커밋 진행

**스테이징된 파일이 없는 경우:**
1. 변경된 파일과 추적되지 않는 파일 목록 표시
2. 사용자에게 다음 옵션 제시:
   - 모든 변경사항 스테이징 (git add .)
   - 특정 파일만 스테이징
   - 커밋 취소
3. 사용자 선택에 따라 스테이징 실행

### 4단계: 커밋 메시지 준비

**사용자가 메시지를 제공한 경우:**
- 제공된 메시지 사용

**메시지가 없는 경우:**
1. 변경사항 분석:
   ```bash
   git diff --staged --stat
   ```
2. 변경 유형 파악:
   - 새 파일 추가
   - 파일 수정
   - 파일 삭제
   - 리팩토링
3. 구조화된 커밋 메시지 자동 생성:
   - 제목: 50자 이내로 변경사항 요약
   - 본문: 필요시 상세 설명 추가
   - 변경된 파일 수와 유형 명시
   - **중요**: Claude Code 서명이나 Co-authored-by 태그를 절대 추가하지 않음
   - **자동 커밋**: 메시지 생성 후 사용자 확인 없이 즉시 커밋 진행

### 5단계: 커밋 실행
```bash
git commit -m "커밋 메시지"
```

커밋 성공 후:
- 커밋 해시 표시
- 변경된 파일 수 요약
- 현재 브랜치 정보 표시

### 6단계: 결과 확인
```bash
git log --oneline -1
```
마지막 커밋 정보를 표시하여 성공적으로 커밋되었음을 확인

## 출력 형식

### 상태 표시
```
📊 Git 저장소 상태
━━━━━━━━━━━━━━━━━━━━━━━━━━━
브랜치: main
스테이징된 파일: 3개
수정된 파일: 2개
추적되지 않는 파일: 1개
```

### 파일 목록
```
스테이징된 변경사항:
  ✅ src/main.py (수정됨)
  ✅ README.md (수정됨)
  ✅ tests/test_main.py (새 파일)

스테이징되지 않은 변경사항:
  📝 config.json (수정됨)
  📝 .env (수정됨)

추적되지 않는 파일:
  ❓ temp.txt
```

### 커밋 결과
```
✨ 커밋 성공!
━━━━━━━━━━━━━━━━━━━━━━━━━━━
커밋 ID: abc1234
메시지: 기능 추가: 사용자 인증 모듈 구현
변경사항: 3개 파일 변경, 150줄 추가, 20줄 삭제
```

## 품질 보증

### 검증 단계
1. **Git 저장소 확인**: 현재 디렉토리가 Git 저장소인지 검증
2. **변경사항 존재 여부**: 커밋할 변경사항이 있는지 확인
3. **커밋 메시지 품질**:
   - 제목이 50자를 넘지 않는지 확인
   - 의미 있는 설명이 포함되었는지 검증
   - 한글/영문 일관성 유지
4. **충돌 가능성**: 병합 충돌 가능성 사전 경고

### 예외 처리
- **Git 저장소가 아닌 경우**: 명확한 오류 메시지와 git init 안내
- **변경사항이 없는 경우**: 이미 모든 것이 커밋되었음을 알림
- **스테이징 실패**: 파일별 오류 원인 표시
- **커밋 실패**: 상세한 오류 메시지와 해결 방법 제시

### 모범 사례 적용
- **원자적 커밋**: 관련된 변경사항만 함께 커밋하도록 안내
- **의미 있는 메시지**: 커밋 메시지 작성 가이드라인 제공
- **커밋 전 검토**: 스테이징된 변경사항 최종 확인 단계
- **히스토리 관리**: 깔끔한 커밋 히스토리 유지 팁 제공

## 사용자 상호작용

### 확인 프롬프트
변경사항 스테이징 시 사용자 확인을 받습니다:
- "모든 변경사항을 스테이징하시겠습니까? (y/n)"
- "추적되지 않는 파일도 포함하시겠습니까?"

### 도움말 제공
각 단계에서 수행되는 작업을 설명하여 Git을 처음 사용하는 사용자도 이해할 수 있도록 합니다.

## 고급 기능

### 스마트 메시지 생성
변경사항의 패턴을 분석하여 적절한 커밋 메시지 형식을 자동으로 선택:
- **기능 추가**: "feat: 새로운 기능 설명"
- **버그 수정**: "fix: 수정된 문제 설명"
- **문서 업데이트**: "docs: 문서 변경 내용"
- **리팩토링**: "refactor: 개선된 코드 구조"
- **테스트 추가**: "test: 테스트 케이스 설명"

### 변경사항 요약
커밋 전 변경사항을 카테고리별로 정리하여 보여줍니다:
- 추가된 기능
- 수정된 버그
- 개선된 성능
- 업데이트된 문서

### 커밋 규칙 준수
프로젝트의 커밋 규칙(있는 경우)을 자동으로 감지하고 준수:
- Conventional Commits 형식
- 이슈 번호 자동 추가
- **Claude Code 서명 제외**: 절대로 "🤖 Generated with Claude Code"나 "Co-authored-by: Claude" 등의 서명을 추가하지 않음