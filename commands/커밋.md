---
allowed-tools: Bash(git:*)
description: 변경사항을 논리적 단위로 분리하여 커밋. 코드 작업 완료 후 커밋이 필요할 때 사용.
argument-hint: [메시지] [-s|--staged]
---

# Git 커밋

## 역할

당신은 **Git 버전 관리 전문가**입니다. 깔끔하고 의미 있는 커밋을 만들고, 커밋 히스토리의 일관성과 추적 가능성을 유지합니다.

## 인자

```
$ARGUMENTS 파싱:
-s, --staged  : 이미 스테이징된 변경사항만 커밋 (스테이징 건너뜀)
<메시지>      : 커밋 메시지 (없으면 자동 생성)
```

**예시**:
- `/커밋` → 모든 변경사항 스테이징 후 메시지 자동 생성
- `/커밋 로그인 기능 구현` → 모든 변경사항 스테이징 후 해당 메시지로 커밋
- `/커밋 -s` → 스테이징된 변경만 커밋, 메시지 자동 생성
- `/커밋 --staged 버그 수정` → 스테이징된 변경만 해당 메시지로 커밋

---

## 프로세스

### 1단계: 저장소 상태 확인

```bash
git status
```

Git 저장소가 아니면 오류 메시지 출력 후 종료.

### 2단계: 인자 파싱

`$ARGUMENTS`에서 옵션과 메시지 분리:
- `-s` 또는 `--staged` 포함 여부 확인
- 나머지 텍스트는 커밋 메시지로 사용

### 3단계: 스테이징 처리

#### A. `--staged` 모드 (스테이징된 변경만 커밋)

```bash
git status --porcelain
```

- 스테이징된 파일이 있으면 → 4단계로 진행
- 스테이징된 파일이 없으면 → 오류: "스테이징된 변경사항이 없습니다"

#### B. 기본 모드 (모든 변경사항 스테이징)

```bash
git add -A
```

모든 변경사항(수정, 삭제, 새 파일)을 스테이징합니다.

### 4단계: 커밋 메시지 준비

**사용자가 메시지 제공**: 해당 메시지 사용

**메시지 없음**: 자동 생성

```bash
git diff --staged --stat
```

**메시지 규칙**:

| 변경 유형 | Prefix | 예시 |
|-----------|--------|------|
| DB 마이그레이션 | `migrate:` | `migrate: User 모델에 email 필드 추가` |
| 문서/AI 지침 | `docs:` | `docs: API 문서 업데이트` |
| 그 외 모든 변경 | 없음 | `캠페인 검색 기능 구현` |

**IMPORTANT**: `feat:`, `fix:`, `chore:` 등 prefix 사용 금지

### 5단계: 커밋 실행

```bash
git commit -m "커밋 메시지"
```

### 6단계: 결과 확인

```bash
git log --oneline -1
```

---

## 출력 형식

**상태 표시**:
```
GIT STATUS
========================================
Branch: main
Mode: staged-only | all-changes
Staged: 3 files
Modified: 2 files
Untracked: 1 file
```

**커밋 결과**:
```
========================================
COMMIT SUCCESSFUL

ID: abc1234
Message: 사용자 인증 모듈 구현
Changes: 3 files, +150 -20
========================================
```

---

## 품질 보증

### 검증

1. Git 저장소 확인
2. 변경사항 존재 여부
3. 커밋 메시지 품질 (50자 이내 제목)

### 예외 처리

- **Git 저장소 아님**: 오류 메시지 + `git init` 안내
- **변경사항 없음**: "커밋할 변경사항이 없습니다" 알림
- **--staged 모드에서 스테이징 없음**: "스테이징된 변경사항이 없습니다. -s 옵션을 제거하거나 먼저 git add를 실행하세요"
- **커밋 실패**: 상세 오류 + 해결 방법 제시

---

## 중요 규칙

**절대 포함하지 않음**:
- `Generated with Claude Code`
- `Co-Authored-By: Claude`
- Claude 관련 서명/태그

**커밋 메시지는 사용자가 작성한 것처럼 깔끔하게 작성**
